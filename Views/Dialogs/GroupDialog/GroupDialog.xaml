<UserControl x:Class="AccountManager.Views.Dialogs.GroupDialog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:helpers="clr-namespace:AccountManager.Utilities.Helpers"
             xmlns:components="clr-namespace:AccountManager.Views.Components"
             Background="Transparent">

    <Border Style="{StaticResource GlassPanel}" 
            MinWidth="490" MaxWidth="490" MaxHeight="800"
            Background="{DynamicResource MainBackgroundColor}">
        <Grid Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="0,0,0,24">
                <TextBlock Text="{Binding Title}" 
                        FontSize="24" 
                        FontWeight="Bold"
                        Foreground="{DynamicResource TextPrimaryColor}"
                        HorizontalAlignment="Left"
                        Margin="0,0,0,8"/>
                
                <TextBlock Text="{Binding Subtitle}" 
                        FontSize="14"
                        Foreground="{DynamicResource TextSecondaryColor}"
                        HorizontalAlignment="Left"
                        Margin="0,0,0,0"/>
            </StackPanel>

            <!-- Group Name with Preview -->
            <StackPanel Grid.Row="1" Margin="0,0,0,32">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Icon Preview -->
                    <Border Grid.Column="0" 
                            Background="{Binding TempGroup.ColorVariant, Converter={StaticResource OpacityBrushConverter}, ConverterParameter=0.2}"
                            Width="46" Height="46"
                            CornerRadius="23"
                            Margin="0,0,12,0"
                            VerticalAlignment="Top">
                        <materialDesign:PackIcon Kind="{Binding TempGroup.Icon}" 
                            Foreground="{Binding TempGroup.ColorVariant}"
                            Width="23" Height="23"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"/>
                    </Border>

                    <!-- Name Input -->
                    <TextBox Grid.Column="1" 
                            Text="{Binding GroupName, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource AdvancedTextBox}"
                            helpers:TextBoxHelper.Label="Name"
                            helpers:TextBoxHelper.MaxChars="40"
                            helpers:TextBoxHelper.Placeholder="Enter your vault name here..." 
                            helpers:TextBoxHelper.Info="Only numbers and letters are allowed."/>
                </Grid>
            </StackPanel>

            <!-- Color Selection Section -->
            <StackPanel Grid.Row="2" Margin="0,0,0,36">
                <TextBlock Text="Choose Color" 
                          FontSize="16" 
                          FontWeight="SemiBold"
                          Foreground="{DynamicResource TextPrimaryColor}"
                          Margin="0,0,0,20"/>
                          
                <!-- Color Picker Component -->
                <components:ColorPicker 
                SelectedColor="{Binding DataContext.TempGroup.ColorVariant, 
                        RelativeSource={RelativeSource AncestorType=UserControl}, 
                        Mode=TwoWay}" />
            </StackPanel>

            <!-- Icon Selection Section -->
            <StackPanel Grid.Row="3" Margin="0,0,0,32">
                <TextBlock Text="Choose Icon" 
                          FontSize="16" 
                          FontWeight="SemiBold"
                          Foreground="{DynamicResource TextPrimaryColor}"
                          Margin="0,0,0,20"/>
                          
                <!-- Icon Picker Component -->
                <components:IconPicker 
                SelectedIcon="{Binding DataContext.TempGroup.Icon, 
                        RelativeSource={RelativeSource AncestorType=UserControl}, 
                        Mode=TwoWay}" />
            </StackPanel>

            <!-- Actions -->
            <StackPanel Grid.Row="5" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Margin="0,24,0,0">
                <Button Content="Cancel" 
                      Style="{StaticResource SecondaryButton}"
                      MinWidth="100"
                      Margin="0,0,16,0"/>
                
                <Button Content="{Binding ActionButtonText}" 
                      Style="{StaticResource PrimaryButton}"
                      MinWidth="100"
                      IsEnabled="{Binding CanSave}"/>
            </StackPanel>
        </Grid>
    </Border>

</UserControl>