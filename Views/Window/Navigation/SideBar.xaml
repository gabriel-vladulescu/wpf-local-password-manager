<UserControl x:Class="AccountManager.Views.Window.Navigation.Sidebar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:navigationViews="clr-namespace:AccountManager.Views.Window.Navigation"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">

    <Border Background="{DynamicResource SidebarColor}" CornerRadius="0">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="20"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Groups Header -->
            <StackPanel Grid.Row="1" Margin="24,0,24,20">
                <TextBlock Text="Groups" 
                          Foreground="{DynamicResource SidebarTextPrimaryColor}"
                          FontSize="18" 
                          FontWeight="Bold"/>
                <TextBlock Text="Organize your accounts" 
                          Foreground="{DynamicResource SidebarTextSecondaryColor}" 
                          Opacity="0.7"
                          FontSize="13"
                          Margin="0,4,0,0"/>
            </StackPanel>

            <!-- Groups List -->
            <ListBox Grid.Row="2" 
                     ItemsSource="{Binding Groups}"
                     SelectedItem="{Binding SelectedGroup}"
                     Background="Transparent"
                     BorderThickness="0"
                     Margin="0,0">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Padding="8,12,0,12" 
                                CornerRadius="12"
                                Margin="0,3">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>          
                                    <ColumnDefinition Width="Auto"/>          
                                    <ColumnDefinition Width="Auto"/>       
                                </Grid.ColumnDefinitions>
                                
                                <!-- Group Icon -->
                                <Border Grid.Column="0" 
                                        Background="{StaticResource PrimaryColor}"
                                        Width="40" Height="40"
                                        CornerRadius="20">
                                    <materialDesign:PackIcon Kind="Folder" 
                                                            Foreground="White"
                                                            Width="20" Height="20"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- Group Info -->
                                <StackPanel Grid.Column="1" 
                                           Margin="14,0,10,0"
                                           VerticalAlignment="Center" 
                                           HorizontalAlignment="Right"
                                           MinWidth="150"
                                           MaxWidth="150">
                                    <TextBlock Text="{Binding Name}" 
                                              Foreground="{DynamicResource SidebarTextPrimaryColor}"
                                              FontSize="15" 
                                              FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding Accounts.Count, StringFormat={}{0} accounts}" 
                                              Foreground="{DynamicResource SidebarTextSecondaryColor}"
                                              Opacity="0.7"
                                              FontSize="12"/>
                                </StackPanel>
                                
                                <!-- Action Buttons -->
                                <StackPanel Grid.Column="2"
                                           Orientation="Horizontal" 
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Stretch">
                                    <Button Style="{StaticResource MaterialDesignIconButton}"
                                            Command="{Binding DataContext.EditGroupCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"
                                            Width="32" Height="32"
                                            ToolTip="Edit Group">
                                        <materialDesign:PackIcon Kind="Pencil" 
                                                                Foreground="{DynamicResource SidebarTextSecondaryColor}" 
                                                                Opacity="0.7"
                                                                Width="16" Height="16"/>
                                    </Button>
                                    <Button Style="{StaticResource MaterialDesignIconButton}"
                                            Command="{Binding DataContext.DeleteGroupCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"
                                            Width="32" Height="32"
                                            ToolTip="Delete Group"
                                            Margin="4,0,0,0">
                                        <materialDesign:PackIcon Kind="Delete" 
                                                                Foreground="{StaticResource DangerColor}" 
                                                                Width="16" Height="16"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <!-- Add Group Button -->
            <navigationViews:AddGroupButton Grid.Row="3" />
        </Grid>
    </Border>

</UserControl>